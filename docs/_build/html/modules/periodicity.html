<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Periodicity &#8212; Plot3D 1.6.8 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css?v=def86cc0" />
    
    <script src="../_static/documentation_options.js?v=514bbfa0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Splitting Blocks" href="split_block.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="split_block.html" title="Splitting Blocks"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Plot3D 1.6.8 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Periodicity</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-plot3d.periodicity">
<span id="periodicity"></span><h1>Periodicity<a class="headerlink" href="#module-plot3d.periodicity" title="Link to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="plot3d.periodicity.__periodicity_check__">
<span class="sig-prename descclassname"><span class="pre">plot3d.periodicity.</span></span><span class="sig-name descname"><span class="pre">__periodicity_check__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">face1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Face</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">face2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Face</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="block.html#plot3d.block.Block" title="plot3d.block.Block"><span class="pre">Block</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">block2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="block.html#plot3d.block.Block" title="plot3d.block.Block"><span class="pre">Block</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plot3d/periodicity.html#__periodicity_check__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plot3d.periodicity.__periodicity_check__" title="Link to this definition">¶</a></dt>
<dd><p>General function to find periodicity within a given block.</p>
<dl class="simple">
<dt>Steps:</dt><dd><ul class="simple">
<li><p>1: Take the face with the shorter diagonal.</p></li>
<li><p>2: Rotate the shorter face by angle 360/nblades.</p></li>
<li><p>3: Check to see if faces intersect</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>face1</strong> (<em>Face</em>) – An arbitrary face</p></li>
<li><p><strong>face2</strong> (<em>Face</em>) – An arbitrary face</p></li>
<li><p><strong>block1</strong> (<a class="reference internal" href="block.html#plot3d.block.Block" title="plot3d.block.Block"><em>Block</em></a>) – block 1 cooresponding to face 1</p></li>
<li><p><strong>block2</strong> (<a class="reference internal" href="block.html#plot3d.block.Block" title="plot3d.block.Block"><em>Block</em></a>) – block 2 cooresponding to face 2</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>containing</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>df</strong> (pandas.Dataframe): List of point matches for periodic surfaces</p></li>
<li><p><strong>periodic_surface</strong> (List[Face]):  These are faces that are periodic</p></li>
<li><p><strong>split_surfaces</strong> (List[Face]): Some blocks may have periodic faces with other blocks. But the faces may need to be split so say you pair a small face with a larger face. The split surfaces should be treated as an outer face</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plot3d.periodicity.create_rotation_matrix">
<span class="sig-prename descclassname"><span class="pre">plot3d.periodicity.</span></span><span class="sig-name descname"><span class="pre">create_rotation_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rotation_angle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotation_axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'x'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plot3d/periodicity.html#create_rotation_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plot3d.periodicity.create_rotation_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Creates a rotation matrix given an angle and axis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rotation_angle</strong> (<em>float</em>) – Rotation angle in radians</p></li>
<li><p><strong>rotation_axis</strong> (<em>str</em><em>, </em><em>optional</em>) – Axis of rotation “x”, “y”, or “z”. Defaults to “x”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>3x3 rotation matrix</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plot3d.periodicity.linear_real_transform">
<span class="sig-prename descclassname"><span class="pre">plot3d.periodicity.</span></span><span class="sig-name descname"><span class="pre">linear_real_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">face1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Face</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">face2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Face</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span></span></span><a class="reference internal" href="../_modules/plot3d/periodicity.html#linear_real_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plot3d.periodicity.linear_real_transform" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Computes the rotation angle from Face1 to Face2. This can be used to check if the faces are periodic</dt><dd><p>This function assumes the rotation axis is in the “x” direction. This is good for faces within the same block</p>
</dd>
<dt>Reference:</dt><dd><ul class="simple">
<li><p>Linear Real Transforms from GlennHT <a class="reference external" href="https://gitlab.grc.nasa.gov/lte-turbo/GlennHT/-/blob/master/src/M_ccMBMesh.F">https://gitlab.grc.nasa.gov/lte-turbo/GlennHT/-/blob/master/src/M_ccMBMesh.F</a> See computeLRT</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Face1</strong> (<em>Face</em>) – Face to rotate</p></li>
<li><p><strong>Face2</strong> (<em>Face</em>) – Face to rotate to</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple containing:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>ang</strong> (float): rotation angle</p></li>
<li><p><strong>rotation_matrix</strong> (numpy.ndarray): Rotation matrix 3x3</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plot3d.periodicity.periodicity">
<span class="sig-prename descclassname"><span class="pre">plot3d.periodicity.</span></span><span class="sig-name descname"><span class="pre">periodicity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blocks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="block.html#plot3d.block.Block" title="plot3d.block.Block"><span class="pre">Block</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outer_faces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matched_faces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic_direction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotation_axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nblades</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">55</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plot3d/periodicity.html#periodicity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plot3d.periodicity.periodicity" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>This function is used to check for periodicity of the other faces rotated about an axis. Use periodicity_fast instead. Periodicity_fast calls this function after reducing the size of the mesh.</dt><dd><p>The way it works is to find faces of a constant i,j, or k value</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>blocks</strong> (<em>List</em><em>[</em><a class="reference internal" href="block.html#plot3d.block.Block" title="plot3d.block.Block"><em>Block</em></a><em>]</em>) – List of blocks that will be scanned for perodicity</p></li>
<li><p><strong>outer_faces</strong> (<em>List</em><em>[</em><em>Dict</em><em>[</em><em>str</em><em>,</em><em>int</em><em>]</em><em>]</em>) – List of outer faces for each block as a dictionary format. You can get this from connectivity</p></li>
<li><p><strong>matched_faces</strong> (<em>ListList</em><em>[</em><em>Dict</em><em>[</em><em>str</em><em>,</em><em>int</em><em>]</em><em>]</em>) – List of matched faces from connectivity. Matched faces was added so that it’s always removed from outer faces</p></li>
<li><p><strong>periodic_direction</strong> (<em>str</em>) – either i,j,k to look for</p></li>
<li><p><strong>rotation_axis</strong> (<em>str</em>) – either x,y,z</p></li>
<li><p><strong>nblades</strong> (<em>int</em>) – Number of blades to consider, this affects the rotation angle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>containing</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>periodic_faces_export</strong> (List[Dict[str,int]]):  This is list of all the surfaces/faces that match when rotated by an angle formatted as a dictionary.</p></li>
<li><p><strong>outer_faces_export</strong> (List[Dict[str,int]]): These are the list of outer faces that are not periodic formatted as a dictionary.</p></li>
<li><p><strong>periodic_faces</strong> (List[Tuple[Face,Face]]): - This is a list of Face objects that are connected to each other organized as a list of tuples: [Face1, Face2] where Face 1 will contain the block number and the diagonals [IMIN,JMIN,KMIN,IMAX,JMAX,KMAX]. Example: blk: 1 [168,0,0,268,100,0].</p></li>
<li><p><strong>outer_faces_all</strong> (List[Face]): This is a list of outer faces save as a list of Faces</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(Tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plot3d.periodicity.periodicity_fast">
<span class="sig-prename descclassname"><span class="pre">plot3d.periodicity.</span></span><span class="sig-name descname"><span class="pre">periodicity_fast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blocks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="block.html#plot3d.block.Block" title="plot3d.block.Block"><span class="pre">Block</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outer_faces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Face</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matched_faces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic_direction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotation_axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nblades</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">55</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plot3d/periodicity.html#periodicity_fast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plot3d.periodicity.periodicity_fast" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Finds the connectivity of blocks when they are rotated by an angle defined by the number of blades. Only use this if your mesh is of an annulus.</dt><dd><p>This function reduces the size of the blocks by a factor of the minimum gcd. This speeds up finding the connectivity</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>blocks</strong> (<em>List</em><em>[</em><a class="reference internal" href="block.html#plot3d.block.Block" title="plot3d.block.Block"><em>Block</em></a><em>]</em>) – List of blocks that will be scanned for perodicity</p></li>
<li><p><strong>outer_faces</strong> (<em>List</em><em>[</em><em>Dict</em><em>[</em><em>str</em><em>,</em><em>int</em><em>]</em><em>]</em>) – List of outer faces for each block as a dictionary format. You can get this from connectivity</p></li>
<li><p><strong>matched_faces</strong> (<em>ListList</em><em>[</em><em>Dict</em><em>[</em><em>str</em><em>,</em><em>int</em><em>]</em><em>]</em>) – List of matched faces from connectivity. Matched faces was added so that it’s always removed from outer faces</p></li>
<li><p><strong>periodic_direction</strong> (<em>str</em>) – either i,j,k to look for</p></li>
<li><p><strong>rotation_axis</strong> (<em>str</em>) – either x,y,z</p></li>
<li><p><strong>nblades</strong> (<em>int</em>) – Number of blades to consider, this affects the rotation angle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>containing</p>
<ul class="simple">
<li><p><strong>periodic_faces_export</strong> (List[Dict[str,int]]):  This is list of all the surfaces/faces that match when rotated by an angle formatted as a dictionary.</p></li>
<li><p><strong>outer_faces_export</strong> (List[Dict[str,int]]): These are the list of outer faces that are not periodic formatted as a dictionary.</p></li>
<li><p><strong>periodic_faces</strong> (List[Tuple[Face,Face]]): - This is a list of Face objects that are connected to each other organized as a list of tuples: [Face1, Face2] where Face 1 will contain the block number and the diagonals [IMIN,JMIN,KMIN,IMAX,JMAX,KMAX]. Example: blk: 1 [168,0,0,268,100,0].</p></li>
<li><p><strong>outer_faces_all</strong> (List[Face]): This is a list of outer faces save as a list of Faces</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(Tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plot3d.periodicity.rotated_periodicity">
<span class="sig-prename descclassname"><span class="pre">plot3d.periodicity.</span></span><span class="sig-name descname"><span class="pre">rotated_periodicity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blocks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="block.html#plot3d.block.Block" title="plot3d.block.Block"><span class="pre">Block</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matched_faces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outer_faces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotation_angle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotation_axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ReduceMesh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plot3d/periodicity.html#rotated_periodicity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plot3d.periodicity.rotated_periodicity" title="Link to this definition">¶</a></dt>
<dd><p>Finds the peridocity/connectivity by rotating a block. This is a bit different from “periodicity_fast” where you specify the periodic direction. This method doesn’t care about the direction as long as the angle you specify results in a match between the Left Face and the Right Face. I would use this instead.</p>
<dl class="simple">
<dt>Example 1:</dt><dd><p>L      RL           R
| blk1 || Copy blk1 |
| blk2 || Copy blk2 |
| blk3 || Copy blk3 |
Rotates the set of blocks by an angle and checks the matching surfaces for R and L.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>blocks</strong> (<em>List</em><em>[</em><a class="reference internal" href="block.html#plot3d.block.Block" title="plot3d.block.Block"><em>Block</em></a><em>]</em>) – List of blocks for a particular geometry. Do not duplicate the geometry and pass it in!</p></li>
<li><p><strong>outer_faces</strong> (<em>List</em><em>[</em><em>Dict</em><em>[</em><em>str</em><em>,</em><em>int</em><em>]</em><em>]</em>) – List of outer faces in dictionary form</p></li>
<li><p><strong>rotation_angle</strong> (<em>float</em>) – rotation angle in between geometry in degrees.</p></li>
<li><p><strong>rotation_axis</strong> (<em>str</em><em>, </em><em>Optional</em>) – “x”, “y”, or “z”</p></li>
<li><p><strong>ReduceMesh</strong> (<em>bool</em><em>, </em><em>Optional</em>) – True, reduces the mesh for faster matching</p></li>
</ul>
</dd>
</dl>
<p>periodic_faces, outer_faces_export, _, _ = rotated_periodicity(blocks,face_matches, outer_faces, rotation_angle=rotation_angle, rotation_axis = “x”)</p>
<dl>
<dt>Replaces:</dt><dd><p>Is the same as</p>
<p>periodic_surfaces, outer_faces_to_keep,periodic_faces,outer_faces = periodicity_fast(blocks,outer_faces,face_matches,periodic_direction=’k’,rotation_axis=’x’,nblades=55)
and
periodic_surfaces, outer_faces_to_keep,periodic_faces,outer_faces = periodicity(blocks,outer_faces,face_matches,periodic_direction=’k’,rotation_axis=’x’,nblades=55)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>containing</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>periodic_faces_export</strong> (List[Dict[str,int]]):  This is list of all the surfaces/faces that match when rotated by an angle formatted as a dictionary.</p></li>
<li><p><strong>outer_faces_export</strong> (List[Dict[str,int]]): These are the list of outer faces that are not periodic formatted as a dictionary.</p></li>
<li><p><strong>periodic_faces</strong> (List[Tuple[Face,Face]]): - This is a list of Face objects that are connected to each other organized as a list of tuples: [Face1, Face2] where Face 1 will contain the block number and the diagonals [IMIN,JMIN,KMIN,IMAX,JMAX,KMAX]. Example: blk: 1 [168,0,0,268,100,0].</p></li>
<li><p><strong>outer_faces_all</strong> (List[Face]): This is a list of outer faces save as a list of Faces</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>(Tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plot3d.periodicity.translational_periodicity">
<span class="sig-prename descclassname"><span class="pre">plot3d.periodicity.</span></span><span class="sig-name descname"><span class="pre">translational_periodicity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blocks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="block.html#plot3d.block.Block" title="plot3d.block.Block"><span class="pre">Block</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outer_faces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">translational_direction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'z'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_tol_xyz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_shared_frac</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.02</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_shared_abs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride_u</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride_v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Face</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Face</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/plot3d/periodicity.html#translational_periodicity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plot3d.periodicity.translational_periodicity" title="Link to this definition">¶</a></dt>
<dd><p>Detect translational periodicity between block faces along a given axis.</p>
<p>This function takes a set of outer block faces and attempts to identify
periodic counterparts across the domain in the specified translational
direction (‘x’, ‘y’, or ‘z’). It works by:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><strong>Bounding faces:</strong> Uses <cite>find_bounding_faces</cite> to identify candidate
lower/upper faces for the given axis.</p></li>
<li><p><strong>Grid reduction:</strong> Reduces blocks to their greatest common divisor
(GCD) resolution to make indexing consistent across blocks.</p></li>
<li><p><strong>Shifting:</strong> Creates shifted copies of all blocks in both positive
and negative directions along the periodic axis.</p></li>
<li><p><strong>Precheck in orthogonal plane:</strong> Uses a fast projection test
(orthogonal to the periodic axis) to determine whether two faces
could possibly match. This greatly reduces false negatives when
spacing/tolerances differ slightly.</p></li>
<li><p><strong>Node-based match:</strong> Calls <cite>Face.touches_by_nodes</cite> on candidate
pairs to check shared node positions, with an adaptive tolerance
based on the in-plane spacing of each face.</p></li>
<li><p><strong>Pairing:</strong> Records each valid pair of periodic faces, their
IJK index mappings (min→min or min→max), and removes matched faces
from the outer-face list.</p></li>
<li><p><strong>Scaling back:</strong> Rescales reduced indices back to the original grid
spacing so results are consistent with input block resolution.</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>blocks</strong> (<em>List</em><em>[</em><a class="reference internal" href="block.html#plot3d.block.Block" title="plot3d.block.Block"><em>Block</em></a><em>]</em>) – List of blocks.</p></li>
<li><p><strong>outer_faces</strong> (<em>List</em><em>[</em><em>Dict</em><em>[</em><em>str</em><em>,</em><em>int</em><em>]</em><em>]</em>) – Outer faces represented as
dictionaries (with IMIN, JMIN, KMIN, IMAX, JMAX, KMAX).</p></li>
<li><p><strong>delta</strong> (<em>float</em><em>, </em><em>optional</em>) – Periodicity spacing along the chosen axis.
If None, it is inferred from the global block min/max extent.</p></li>
<li><p><strong>translational_direction</strong> (<em>str</em><em>, </em><em>optional</em>) – Axis to check (‘x’,’y’,’z’).
Default is ‘z’.</p></li>
<li><p><strong>node_tol_xyz</strong> (<em>float</em><em>, </em><em>optional</em>) – Absolute coordinate tolerance for
node-matching. If None, tolerance is computed adaptively based
on median in-plane spacing of candidate faces.</p></li>
<li><p><strong>min_shared_frac</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum fraction of nodes that must
overlap for two faces to be considered periodic. Default 0.02.</p></li>
<li><p><strong>min_shared_abs</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum absolute number of shared nodes.
Default 4.</p></li>
<li><p><strong>stride_u</strong> (<em>int</em><em>, </em><em>optional</em>) – Subsampling stride along the first face index
direction. Default 1 (no skipping).</p></li>
<li><p><strong>stride_v</strong> (<em>int</em><em>, </em><em>optional</em>) – Subsampling stride along the second face index
direction. Default 1 (no skipping).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple[</dt><dd><p>List[Dict[str, Dict[str,int]]],
List[Tuple[Face, Face, Dict[str,str]]],
List[Dict[str,int]]</p>
</dd>
<dt>]:</dt><dd><ul class="simple">
<li><p><strong>periodic_faces_export</strong>: Export-ready dictionaries describing
each periodic pair (block indices, face extents, index mapping,
and match mode).</p></li>
<li><p><strong>periodic_pairs</strong>: Matched periodic face pairs as <cite>Face</cite> objects
with IJK mapping.</p></li>
<li><p><strong>outer_faces_remaining</strong>: Updated list of outer faces with
periodic ones removed (preserving any existing <cite>id</cite> fields).</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Works for periodicity in <strong>x</strong>, <strong>y</strong>, or <strong>z</strong> directions.</p></li>
<li><p>The adaptive tolerance makes the method robust to small spacing
differences between blocks.</p></li>
<li><p>The orthogonal-plane precheck avoids expensive node comparisons
when faces clearly do not align.</p></li>
</ul>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Periodicity</a><ul>
<li><a class="reference internal" href="#plot3d.periodicity.__periodicity_check__"><code class="docutils literal notranslate"><span class="pre">__periodicity_check__()</span></code></a></li>
<li><a class="reference internal" href="#plot3d.periodicity.create_rotation_matrix"><code class="docutils literal notranslate"><span class="pre">create_rotation_matrix()</span></code></a></li>
<li><a class="reference internal" href="#plot3d.periodicity.linear_real_transform"><code class="docutils literal notranslate"><span class="pre">linear_real_transform()</span></code></a></li>
<li><a class="reference internal" href="#plot3d.periodicity.periodicity"><code class="docutils literal notranslate"><span class="pre">periodicity()</span></code></a></li>
<li><a class="reference internal" href="#plot3d.periodicity.periodicity_fast"><code class="docutils literal notranslate"><span class="pre">periodicity_fast()</span></code></a></li>
<li><a class="reference internal" href="#plot3d.periodicity.rotated_periodicity"><code class="docutils literal notranslate"><span class="pre">rotated_periodicity()</span></code></a></li>
<li><a class="reference internal" href="#plot3d.periodicity.translational_periodicity"><code class="docutils literal notranslate"><span class="pre">translational_periodicity()</span></code></a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="split_block.html"
                          title="previous chapter">Splitting Blocks</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/modules/periodicity.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="split_block.html" title="Splitting Blocks"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Plot3D 1.6.8 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Periodicity</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2025, Paht Juangphanich.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    </div>
  </body>
</html>